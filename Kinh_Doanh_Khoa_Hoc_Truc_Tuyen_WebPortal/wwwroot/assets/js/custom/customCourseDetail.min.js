var CourseJquery=function(){function t(){$("#comment-form").submit(function(n){n.preventDefault();var t=$(this),i=t.attr("action");$.post(i,t.serialize()).done(function(n){var r=$("#tmpl_comments").html(),u=Mustache.render(r,{content:n.content,creationTime:moment(n.creationTime).fromNow(),ownerUser:n.ownerUser});$("#reviewer-text").val("");$("#comment_list").prepend(u);var f=parseInt($("#hid_number_of_comments").val()),t=f+1,i=t+" Bình Luận";$("#number-comments-non-login").text(i);$("#number-comments").text(i);$("#span-count-comments").text("("+t+")");$("#hid_number_of_comments").val(t)})});$("body").on("click",".comment-reply-link",function(n){if(n.preventDefault(),$("#hid_current_login_id").val()==="")window.location.href="/login.html";else{var t=$(this).data("commentid"),i=$("#tmpl_reply_comment").html(),r=Mustache.render(i,{commentId:t});$("#reply_comment_"+t).append(r);$("#frm_reply_comment_"+t).submit(function(n){n.preventDefault();var i=$(this),r=i.attr("action");$.post(r,i.serialize()).done(function(n){var u=$("#tmpl_children_comments").html(),f=Mustache.render(u,{id:n.id,content:n.content,creationTime:moment(n.creationTime).fromNow(),ownerUser:n.ownerUser});$("#txt_reply_content_"+t).val("");$("#reply_comment_"+t).html("");$("#children_comments_"+t).prepend(f);var e=parseInt($("#hid_number_of_comments").val()),i=e+1,r=i+" Bình Luận";$("#number-comments-non-login").text(r);$("#number-comments").text(r);$("#span-count-comments").text("("+i+")");$("#hid_number_of_comments").val(i)})})}});$("body").on("click","#comment-pagination",function(t){t.preventDefault();var r=parseInt($("#hid_course_id").val()),i=parseInt($(this).data("page-index"))+1;$(this).data("page-index",i);n(r,i)});$("body").on("click",".replied-comment-pagination",function(n){n.preventDefault();var r=parseInt($("#hid_course_id").val()),u=parseInt($(this).data("id")),t=parseInt($(this).data("page-index"))+1;$(this).data("page-index",t);i(r,u,t)})}function n(n,t){t===undefined&&(t=1);$.get("/Courses/GetCommentById?id="+n+"&pageIndex="+t+"&entityType=courses").done(function(n,t,i){var u,f,r;i.status===200&&(u=$("#tmpl_comments").html(),f=$("#tmpl_children_comments").html(),n&&n.items&&(r="",$.each(n.items,function(n,t){var i="";t.children&&t.children.items&&$.each(t.children.items,function(n,t){i+=Mustache.render(f,{content:t.content,creationTime:moment(t.creationTime).fromNow(),ownerUser:t.ownerUser,id:t.id})});i+=t.children.pageIndex<t.children.pageCount?'<div class="dash__link dash__link--brand u-s-m-y-15"><a href="#" class="replied-comment-pagination" id="replied-comment-pagination-'+t.id+'" data-page-index="1" data-id="'+t.id+'">Xem thêm bình luận<\/a><\/div>':'<div class="dash__link dash__link--brand u-s-m-y-15"><a href="#" class="replied-comment-pagination" id="replied-comment-pagination-'+t.id+'" data-page-index="1" data-id="'+t.id+'" style="display:none">Xem thêm bình luận<\/a><\/div>';r+=Mustache.render(u,{childrenHtml:i,content:t.content,creationTime:moment(t.creationTime).fromNow(),ownerUser:t.ownerUser,id:t.id})}),$("#comment_list").append(r),n.pageIndex<n.pageCount?$("#comment-pagination").show():$("#comment-pagination").hide()))})}function i(n,t,i){i===undefined&&(i=1);$.get("/Courses/GetRepliedCommentById?id="+n+"&pageIndex="+i+"&rootCommentId="+t+"&entityType=courses").done(function(n,i,r){var f,u;r.status===200&&(f=$("#tmpl_children_comments").html(),n&&n.items&&(u="",$.each(n.items,function(n,t){u+=Mustache.render(f,{content:t.content,creationTime:moment(t.creationTime).fromNow(),ownerUser:t.ownerUser,id:t.id})}),$("#children_comments_"+t).prepend(u),n.pageIndex<n.pageCount?$("#replied-comment-pagination-"+t).show():$("#replied-comment-pagination-"+t).hide()))})}this.initialize=function(){var i=parseInt($("#hid_course_id").val());n(i);t()}};