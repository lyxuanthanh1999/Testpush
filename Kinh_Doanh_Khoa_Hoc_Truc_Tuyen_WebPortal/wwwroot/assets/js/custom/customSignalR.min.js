var connection=(new signalR.HubConnectionBuilder).withUrl("https://localhost:44342/notification",{transport:signalR.HttpTransportType.LongPolling,accessTokenFactory:()=>$("#accessToken").val()}).configureLogging(signalR.LogLevel.Information).build();connection.start().catch(n=>console.error(n.toString()));connection.on("ReceiveMessage",()=>{$.ajax({url:"/Account/GetAnnouncements",type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){var i=$("#announcement-template").html(),t="",r="https://localhost:44342";console.log(n.items);n.totalRecords>0?($.each(n.items,function(n,u){t+=Mustache.render(i,{Content:u.content,Id:u.id,Title:u.title,Image:r+u.image,CreationTime:moment(u.creationTime).fromNow()})}),t+=$("#announcement-tag-template").html(),$("#totalAnnouncement").text(n.totalRecords),t!==""&&$("#announcementList").html(t)):$("#announcementList").html('<li><span class="manage-o__text-2 u-c-silver" style="line-height: 1.3; text-align: justify">Không có thông báo chưa đọc<\/span><\/li>')},error:function(){console.log("Có lỗi xảy ra")}})});